
---
title: "NBA Salaries- Question 10"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
    logo: nba1.png
    source_code: embed
    social: menu

runtime: shiny
---

```{r global, include=FALSE}
# load data in 'global' chunk so it can be shared by all users of the dashboard
library(flexdashboard)
library(tidyverse)
library(plotly)
library(knitr)
library(DT)
library(lubridate)
library(shiny)
library(rsconnect)
library(cleaner)

df <- read_csv('https://atess420.github.io/mymath421/nba_salary2.csv')


# Create input variables
nba_team <- unique(df$Tm)
nba_country <- unique(df$NBA_Country)
df$date <- rdate(nrow(df),min = "2022-01-01",
  max = "2023-12-31")
df$age <- df$Age

```

{.sidebar}
=======================================================================

The NBA salary cap is the limit to the total amount of money that National Basketball Association teams are allowed to pay their players. Like the other major professional sports leagues in North America, the NBA has a salary cap to control costs and benefit parity, defined by the league's collective bargaining agreement (CBA). Source: Wikipedia

NOTE: The date data is not real, it is randomly generated by R.

Select the following inputs for the corresponding plots in the tabs:


```{r}
checkboxGroupInput(inputId = "team_input", 
                   label = h3("NBA Team"),
                   choices = nba_team, 
                   inline = TRUE,
                   selected = "HOU")

sliderInput(inputId = "game_input",
            label = h2("Games Played Range"),
            min = min(df$G, na.rm=TRUE),
            max = max(df$G, na.rm=TRUE),
            value= c(10, 60))

sliderInput(inputId = "age_input",
            label = h2("Select Age Range"),
            min = min(df$age, na.rm=TRUE),
            max = max(df$age, na.rm=TRUE),
            value= c(20, 40))

checkboxGroupInput(inputId = "country_input", 
                   label = h3("Countries"),
                   choices = nba_country, 
                   inline = TRUE,
                   selected = "USA")

dateRangeInput(inputId = "date_input", 
               label = h2("Date range"), 
               start = min(df$date), 
               end = max(df$date),
               min = min(df$date), 
               max = max(df$date))
```

Data Table and Info
=======================================================================

Column {data-width=500, .tabset}
-----------------------------------------------------------------------

### Column Tab 1

```{r}
df
```


### Column Tab 2

```{r}
datatable(df, options = list(
  pageLength = 25
))
```


Column {data-width=500}
-----------------------------------------------------------------------

### The NBA

- The National Basketball Association, or NBA, is a professional basketball league comprised of 30 teams across North America featuring the best basketball players in the world

- The NBA is a collection of 30 teams, broken down by two conferences with three divisions apiece. The Western Conference plays host to the Northwest, Pacific and Southwest Divisions

### Logo

![](https://cdn.nba.com/manage/2020/10/NBA_Logoman_2017-horizontal-1-1536x904.jpg)



Player Efficiency Plots
=======================================================================

Column {data-width=500}
-----------------------------------------------------------------------

### Plot 1- Win Shares

```{r}
renderPlotly({
  plot1 <- df %>% 
    filter(Tm %in% input$team_input) %>%
    filter(G>input$game_input[1], G<input$game_input[2]) %>%
    filter(age>input$age_input[1], age<input$age_input[2]) %>%
    filter(NBA_Country %in% input$country_input) %>%
    filter(date > input$date_input[1], date < input$date_input[2]) %>%
    ggplot(aes(x=WS, y=Salary))+
    geom_point()+
    geom_smooth()+
  labs(title = "Win Shares to Salary Contributed",x="Win Shares", y="Salary")
  ggplotly(plot1)
})
```

### Plot 2- Efficiency Rating

```{r}
renderPlotly({
 plot2 <- df %>% 
    filter(Tm %in% input$team_input) %>%
    filter(G>input$game_input[1], G<input$game_input[2]) %>%
    filter(age>input$age_input[1], age<input$age_input[2]) %>%
    filter(NBA_Country %in% input$country_input) %>% 
    filter(date > input$date_input[1], date < input$date_input[2]) %>%
    ggplot(aes(x=PER, y=Salary))+
    geom_point()+
    geom_smooth()+
  labs(title = "Salary by Player Efficiency Rating", x="Player Efficiency Rating", y="Salary")
  ggplotly(plot2)
})
```


Column {data-width=500}
-----------------------------------------------------------------------

### Statistics Glossary

- Win Shares (WS): an estimate of the number of wins contributed by a player
- Player Efficiency Rating (PER): The PER sums up all a player's positive accomplishments, subtracts the negative accomplishments, and returns a per-minute rating of a player's performance

(Source: https://www.basketball-reference.com/about/glossary.html)


Offense vs Defense Plots
=======================================================================

Column {data-width=500}
-----------------------------------------------------------------------

### Plot 3- Offense

```{r}
renderPlotly({
  plot3 <- df %>% 
    filter(Tm %in% input$team_input) %>%
    filter(G>input$game_input[1], G<input$game_input[2]) %>%
    filter(age>input$age_input[1], age<input$age_input[2]) %>%
    filter(NBA_Country %in% input$country_input) %>% 
    filter(date > input$date_input[1], date < input$date_input[2]) %>%
    ggplot(aes(x=`TS%`, y=Salary))+
    geom_point()+
    geom_smooth()+
  labs(title = "Salary vs True Shooting Percentage", x="True Shooting %", y="Salary")
  ggplotly(plot3)
})
```

### Plot 4- Defense

```{r}
renderPlotly({
  plot4 <- df %>% 
    filter(Tm %in% input$team_input) %>%
    filter(G>input$game_input[1], G<input$game_input[2]) %>%
    filter(age>input$age_input[1], age<input$age_input[2]) %>%
    filter(NBA_Country %in% input$country_input) %>%
    filter(date > input$date_input[1], date < input$date_input[2]) %>%
    ggplot(aes(x=`BLK%`, y=Salary))+
    geom_point()+
    geom_smooth()+
  labs(title = "Salary vs Block Percentage", x="Block %", y="Salary")
  ggplotly(plot4)
})
```


Column {data-width=500}
-----------------------------------------------------------------------

### Statistics Glossary

- True Shooting Percentage (TS%): a measure of shooting efficiency that takes into account field goals, 3-point field goals, and free throws
- Block Percentage (BLK%): an estimate of the percentage of opponent two-point field goal attempts blocked by the player while he was on the floor

(Source: https://www.basketball-reference.com/about/glossary.html)


Players Data Plots
=======================================================================

Column {data-width=500}
-----------------------------------------------------------------------

### Plot 5- Games Played

```{r}
renderPlotly({
 plot5 <- df %>% 
    filter(Tm %in% input$team_input) %>%
    filter(G>input$game_input[1], G<input$game_input[2]) %>%
    filter(age>input$age_input[1], age<input$age_input[2]) %>%
    filter(NBA_Country %in% input$country_input) %>%
    filter(date > input$date_input[1], date < input$date_input[2]) %>%
    ggplot(aes(y=Player, x=G))+
    geom_point()+
  labs(title = "Player Games Played", y="Player Name", x="Games Played")
  ggplotly(plot5)
})
```

### Plot 6- Player Country of Origin

```{r}
renderPlotly({
  plot6 <- df %>% 
    filter(Tm %in% input$team_input) %>%
    filter(G>input$game_input[1], G<input$game_input[2]) %>%
    filter(age>input$age_input[1], age<input$age_input[2]) %>%
    filter(NBA_Country %in% input$country_input) %>%
    filter(date > input$date_input[1], date < input$date_input[2]) %>%
    ggplot(aes(y=Player, fill=NBA_Country))+
    geom_bar()+
  labs(title = "Player Country of Origin Percentage", y="Player Name", fill="Country")
  ggplotly(plot6)
})
```


Column {data-width=500}
-----------------------------------------------------------------------

### Statistics Glossary

- Draft Number (NBA_DraftNumber): refers to the placement of when the player was drafted to the NBA
- Team (Tm): refers to an abbreviation of NBA team names

(Source: https://www.basketball-reference.com/about/glossary.html)


Challenges and Advice
=======================================================================

Column {data-width=500}
-----------------------------------------------------------------------

### Errors and Challenges

- Main error: The console couldn't find the "input" from my input variables in my sidebar for my plots, so to resolve this I couldn't have the code for my plots in the beginning code chunk with the inputs, it had to go later in the dashboard

- Challenges: Keeping all of the columns sorted, where I would lose my place in the code and accidentally delete something that I needed, or put the wrong plot under the wrong main tab


Column {data-width=500}
-----------------------------------------------------------------------

### Advice for Someone Else

- Start early, so you have time to ask questions and troubleshoot
- Utilize all resources, like professor, peers, the internet, etc.
- Stay organized, and name each main tab something other than "Main Tab", so it's easier to tell where you are in the code
